<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="java,面试题," />










<meta name="description" content="在面试中，经常会遇到String和Integer的面试题，常常会感到混乱（祭奠我笔试），这次就好好来总结一下String和Integer两者之间的比较关系。 String 首先要从JVM要是讲起， 下面是JVM的内存分区图：    Java栈： 线程私有的，生命周期和线程一样，每个方法执行的时候会创建一个栈帧，用于存储局部变量表，操作数栈，动态链接，方法出口信息等  本地方法栈：提供Native方">
<meta name="keywords" content="java,面试题">
<meta property="og:type" content="article">
<meta property="og:title" content="关于Integer和String">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;12&#x2F;05&#x2F;java%E5%9F%BA%E7%A1%80&#x2F;%E5%85%B3%E4%BA%8EInteger%E5%92%8CString%E8%A7%A3%E9%87%8A&#x2F;index.html">
<meta property="og:site_name" content="Masonluo">
<meta property="og:description" content="在面试中，经常会遇到String和Integer的面试题，常常会感到混乱（祭奠我笔试），这次就好好来总结一下String和Integer两者之间的比较关系。 String 首先要从JVM要是讲起， 下面是JVM的内存分区图：    Java栈： 线程私有的，生命周期和线程一样，每个方法执行的时候会创建一个栈帧，用于存储局部变量表，操作数栈，动态链接，方法出口信息等  本地方法栈：提供Native方">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;006tNbRwgy1g9m9ig9qlxj30sq0jkk3n.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;006tNbRwgy1g9mankbphdj319i0h2jvk.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;006tNbRwgy1g9man7yarrj319i0nojwq.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;006tNbRwgy1g9maxbbntsj31a40nw79z.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;006tNbRwgy1g9maz0d64ej31bg0rwtf5.jpg">
<meta property="og:updated_time" content="2019-12-06T05:59:22.058Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;006tNbRwgy1g9m9ig9qlxj30sq0jkk3n.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/12/05/java基础/关于Integer和String解释/"/>





  <title>关于Integer和String | Masonluo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Masonluo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/05/java%E5%9F%BA%E7%A1%80/%E5%85%B3%E4%BA%8EInteger%E5%92%8CString%E8%A7%A3%E9%87%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Masonluo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Masonluo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">关于Integer和String</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-05T23:10:22+08:00">
                2019-12-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在面试中，经常会遇到String和Integer的面试题，常常会感到混乱（祭奠我笔试），这次就好好来总结一下String和Integer两者之间的比较关系。</p>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p> 首先要从JVM要是讲起， 下面是JVM的内存分区图：</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9m9ig9qlxj30sq0jkk3n.jpg" alt="image-20191205232706568" style="zoom:50%;">

<ul>
<li><p>Java栈： 线程私有的，生命周期和线程一样，每个方法执行的时候会创建一个栈帧，用于存储局部变量表，操作数栈，动态链接，方法出口信息等</p>
</li>
<li><p>本地方法栈：提供Native方法服务，跟虚拟机栈类似</p>
</li>
<li><p>程序计数器：线程私有，保存着当前线程需要执行的指令的地址。</p>
</li>
<li><p><strong>堆</strong>: 是虚拟机所管理的最大的一块内存空间，是所有线程共享的一块内存区域。 所有的对象都在堆上分配。（<strong>但是随着JIT编译器的发展与逃逸分析技术的逐渐成熟，栈上分配、标量替换优化技术会导致一些微妙的改变，所有对象都在堆上分配也不是那么绝对了</strong>）</p>
</li>
<li><p><strong>方法区</strong>：跟Java堆一样，是各个线程共享的内存区域，保存已经被虚拟机加载的<strong>类信息</strong>， <strong>常量</strong>， <strong>静态变量</strong>， <strong>即时编译器遍以后的代码等数据</strong>，也常常被称为<strong>永生代</strong></p>
<ul>
<li><p>运行时常量池：又分为静态常量池和运行时常量池</p>
<ul>
<li><p>静态常量池： Class文件中的常量池，存在于Class文件中</p>
</li>
<li><p>运行时常量池： 存放着运行时的一些常量数据</p>
</li>
<li><p>字符串常量池：<strong>存在于运行时常量池中</strong>， （在JDK7之前存在运行时常量池之中，在JDK7已经将其转移到堆中），使得JVM提高了性能和减少了内存的开销</p>
<p><strong>字符串常量池，每当我们使用String s = “abc”的时候，创建字符串常量，JVM会首先检查字符串常量池，如果该字符串不存在于常量池中，就会先实例化该字符串，并且将其放入常量池中，然后将这个字符串的地址赋值给s</strong></p>
<p><strong>使用字符串常量池，每当我们使用关键字new（String s=new String(”abc”);）创建字符串常量时，JVM会首先检查字符串常量池，如果该字符串已经存在常量池中，那么不再在字符串常量池创建该字符串对象，而直接堆中复制该对象的副本，然后将堆中对象的地址赋值给引用s，如果字符串不存在常量池中，就会实例化该字符串并且将其放到常量池中，然后在堆中复制该对象的副本，然后将堆中对象的地址赋值给引用s。</strong></p>
<p>也就是说，一个是看常量池有没有这个字符串，如果有，就直接返回该字符串的引用，如果没有，则新建，然后返回字符串的引用。一个是看常量池中有没有这个字符串，如果有，那么就复制这个字符串，然后在堆中分配内存。如果没有，则实例化字符串，然后放在常量池里面，然后在堆中复制这个对象的副本。</p>
<p><strong>String.intern()，判断该字符串存不存在常量池中，如果存在，返回常量池中字符串的引用，否则，将字符串加入到常量池中，然后返回引用</strong></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>下面引用自我的书包哪里去了博主的文章：</p>
<blockquote>
<p><a href="https://blog.csdn.net/qq_34490018/article/details/82110578" target="_blank" rel="noopener">https://blog.csdn.net/qq_34490018/article/details/82110578</a></p>
</blockquote>
<p><strong>创建字符串的形式：</strong></p>
<ul>
<li><p>创建字符串的两种基本形式</p>
<ol>
<li>String s1 = “1”</li>
<li>String s2 = new String(“2”);</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9mankbphdj319i0h2jvk.jpg" alt="image-20191206000128962"></p>
<p>当编译的时候，发现常量“1”， 然后就将其增加入静态常量池中（如果不存在的话），然后返回“1”实例的引用给s1</p>
</li>
</ul>
<p>  再来看看s2，s2使用关键词new创建字符串，JVM会首先检查字符串常量池，如果该字符串已经存在常量池中，那么不再在字符串常量池创建该字符串对象，而直接堆中复制该对象的副本，然后将堆中对象的地址赋值给引用s2，如果字符串不存在常量池中，就会实例化该字符串并且将其放到常量池中，然后在堆中复制该对象的副本，然后将堆中对象的地址赋值给引用s2。注意：此时是运行期，那么字符串常量池是在运行时常量池中的</p>
<ul>
<li><p>“+“ 连接形式创建字符串</p>
<ol>
<li><p>String s1 = “1” + “2” + “3”</p>
</li>
<li><p>String s2 = “1” + “3” + new String(“1”) + “4”</p>
<p> <img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9man7yarrj319i0nojwq.jpg" alt="image-20191206000619601"></p>
<ul>
<li><p>当使用 + 连接字符串中含有变量的时候，也是运行期的时候才能确定的；如果刚开始连接的都是字符串常量，<strong>编译后将尽可能多的字符串常量连接在一起，形成新的字符串常量参与后续的连接</strong>，接下来的字符串连接是从左到右依次进行，对于不同的字符串，首先会以最左边的字符串创建<strong>StringBuilder对象</strong>，然后依次堆右边进行append操作，最后通过StringBuilder对象通过toString（）方法转换成String对象</p>
<p>实际上的实现过程为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String s2=<span class="keyword">new</span> StringBuilder(“<span class="number">13</span>”).append(<span class="keyword">new</span> String(“<span class="number">1</span>”)).append(“<span class="number">4</span>”).toString();</span><br></pre></td></tr></table></figure>

<p>​    当使用+进行多个字符串连接时，实际上是产生了一个StringBuilder对象和一个String对象。</p>
</li>
</ul>
</li>
<li><p>String s3 = new String(“a”) + new String(“b”)</p>
</li>
</ol>
</li>
</ul>
<pre><code>   &lt;img src=&quot;https://tva1.sinaimg.cn/large/006tNbRwgy1g9masuo00ej317u0ncn2i.jpg&quot; alt=&quot;image-20191206001144464&quot; style=&quot;zoom:50%;&quot; /&gt;

这个过程和2类似，都是生成一个StringBuilder对象，然后一个个append</code></pre><ul>
<li>String.intern() :  String.intern()是一个Native方法，底层调用C++的 StringTable::intern 方法，源码注释：<strong>当调用 intern 方法时，如果常量池中已经该字符串，则返回池中的字符串；否则将此字符串添加到常量池中，并返回字符串的引用。</strong></li>
</ul>
<h4 id="经典案例"><a href="#经典案例" class="headerlink" title="经典案例"></a>经典案例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">       String s3 = <span class="keyword">new</span> String(<span class="string">"1"</span>) + <span class="keyword">new</span> String(<span class="string">"1"</span>);</span><br><span class="line"> </span><br><span class="line">        System.out.println(s3 == s3.intern());</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在不同jdk运行的结果不同，jdk6为false，jdk7和jdk8为true</p>
<p>我们来看看jdk6的内存模型：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9maxbbntsj31a40nw79z.jpg" alt="image-20191206001601410"></p>
<p>我们知道，常量池是放在方法区的，然后方法区跟Java堆是两个完全分来的区域，所以使用intern方法会返回方法区中的字符串对象，所以两者的引用肯定是不等的。</p>
<p>再来看看jdk8的：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9maz0d64ej31bg0rwtf5.jpg" alt="image-20191206001739627"></p>
<p> JDK8中，字符串常量池已经被转移至Java堆中，开发人员也对intern 方法做了一些修改。因为字符串常量池和new的对象都存于Java堆中，为了优化性能和减少内存开销，当调用 intern 方法时，如果常量池中已经存在该字符串，则返回池中字符串；否则直接存储堆中的引用，也就是字符串常量池中存储的是指向堆里的对象。所以结果为true</p>
<p>下面来看一个案例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       </span><br><span class="line">       String str1 = <span class="string">"abc"</span>;</span><br><span class="line"></span><br><span class="line">       String str2 = <span class="string">"abc"</span>;</span><br><span class="line"></span><br><span class="line">       String str3 = <span class="keyword">new</span> String(<span class="string">"abc"</span>);</span><br><span class="line"></span><br><span class="line">       String str4 = <span class="string">"a"</span>;</span><br><span class="line"></span><br><span class="line">       String str5 = <span class="string">"bc"</span>;</span><br><span class="line"></span><br><span class="line">       String str6 = <span class="keyword">new</span> String(<span class="string">"a"</span>);</span><br><span class="line"></span><br><span class="line">       String str7 = <span class="keyword">new</span> String(<span class="string">"bc"</span>);</span><br><span class="line"></span><br><span class="line">       String str8 = <span class="string">"a"</span> + str5;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">final</span> String str9 = <span class="string">"b"</span>;</span><br><span class="line"></span><br><span class="line">       String str10 = <span class="string">"a"</span> + str9;</span><br><span class="line"></span><br><span class="line">       String str11 = <span class="string">"ab"</span>;</span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == str2); <span class="comment">// 1. true</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == str3); <span class="comment">// 2. false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1.equals(str3)); <span class="comment">// 3. true</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == (str4 + str5)); <span class="comment">// 4.false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == <span class="string">"a"</span> + <span class="string">"bc"</span>); <span class="comment">// 5.true</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == <span class="string">"a"</span> + str5); <span class="comment">// 6.false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == str4 + <span class="string">"bc"</span>); <span class="comment">// 7.false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == <span class="string">"abc"</span>.intern()); <span class="comment">// 8.true</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == (str4 + str5).intern()); <span class="comment">// 9.true</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == str6 + <span class="string">"bc"</span>); <span class="comment">// 10. false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == str6 + str7); <span class="comment">// 11. false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == <span class="string">"a"</span> + str7); <span class="comment">// 12.false</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str1 == str8); <span class="comment">// 13.false</span></span><br><span class="line"></span><br><span class="line">       String str = <span class="keyword">new</span> String(<span class="string">"1"</span>) + <span class="keyword">new</span> String(<span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line">       System.out.println(str == str.intern()); <span class="comment">// 14. true</span></span><br><span class="line"></span><br><span class="line">       System.out.println(str11 == str10); <span class="comment">// 15. true</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>输出结果为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">true</span></span><br></pre></td></tr></table></figure>

<p>解释：</p>
<ol>
<li>因为”abc”这个常量在编译的时候已经加入常量池了，所以返回的都是在常量池这个字符串的引用，所以为true</li>
<li>str3是一个在堆里面分配的对象，所以引用值肯定是不同的，所以为false</li>
<li>equal，比较值，所以为false</li>
<li>str4 + str5，实则是用一个StringBuilder来进行连接，然后再返回一个新的String对象，所以结果比较为false</li>
<li>“a” + “bc”，在编译的时候已经尽可能的把一个常量字符串拼接，所以返回的是在常量池里面的引用，所以为true</li>
<li>“a” + str5, 实则是生成一个StringBuilder对象，然后依次append，返回一个新的对象</li>
<li>跟6一样</li>
<li>无需解释</li>
<li>str4+str5，是“abc”，然后intern返回的是常量池里面的引用，因为已经有了，所以跟str1的引用是一样的</li>
<li>跟6一样</li>
<li>跟6一样</li>
<li>跟6一样</li>
<li>str8实则也是StringBuilder返回的对象，所以为false</li>
<li>在jdk8中，调用一个String对象的intern，实则是复制了这个对象的引用地址到常量池中，所以为true</li>
<li>因为str9使用了final进行修饰，所以也是一个常量。</li>
</ol>
<h3 id="Integer"><a href="#Integer" class="headerlink" title="Integer"></a>Integer</h3><ol>
<li><p>包装对象的自动装箱和自动拆箱</p>
<ul>
<li><strong>自动装箱</strong>：把一个基本数据类型用他们对应的引用类型包装起来，直接将一个int包装为一个Integer，这个过程是自动进行的，而无需显示的<strong>new Integer(i)</strong></li>
<li><strong>自动拆箱：</strong>当把一个包装类型的对象赋值给一个基本数据类型的时候，会进行自动拆箱，比如将Integer 复制给一个int，会进行自动拆箱，不需要显示的调用<strong>Integer.intValue()</strong></li>
<li>自动装箱和拆箱是在编译的时候执行的，编译成字节码的时候就已经执行自动拆装箱，由编译器完成，无需手动指定</li>
<li>当进行自动拆箱的时候，调用的是Integer.intValue()方法，当进行自动装箱的时候，调用的是Integet.valueOf方法</li>
</ul>
</li>
<li><p>一个例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerSolution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> num1 = <span class="number">127</span>;</span><br><span class="line"></span><br><span class="line">        Integer num2 = num1;</span><br><span class="line"></span><br><span class="line">        Integer num3 = <span class="keyword">new</span> Integer(<span class="number">127</span>);</span><br><span class="line"></span><br><span class="line">        Integer num4 = Integer.valueOf(<span class="number">127</span>);</span><br><span class="line"></span><br><span class="line">        Integer num5 = <span class="keyword">new</span> Integer(num1);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> num6 = num2;</span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num2); <span class="comment">// 1. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num3); <span class="comment">// 2. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num4); <span class="comment">// 3. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num5); <span class="comment">// 4. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num2 == num3); <span class="comment">// 5. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num2 == num4); <span class="comment">// 6. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num2 == num5); <span class="comment">// 7. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num3 == num4); <span class="comment">// 8. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num3 == num5); <span class="comment">// 9.false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num4 == num5); <span class="comment">// 10.false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码编译出来的字节码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">➜  interview git:(master) ✗ javap -c IntegerSolution</span><br><span class="line">警告: 二进制文件IntegerSolution包含com.masonluo.practise.algorithm.interview.IntegerSolution</span><br><span class="line">Compiled from <span class="string">"IntegerSolution.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">masonluo</span>.<span class="title">practise</span>.<span class="title">algorithm</span>.<span class="title">interview</span>.<span class="title">IntegerSolution</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> com.masonluo.practise.algorithm.interview.IntegerSolution();</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       1: invokespecial #1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(java.lang.String[])</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: bipush        <span class="number">127</span></span><br><span class="line">       <span class="number">2</span>: istore_1</span><br><span class="line">       <span class="number">3</span>: iload_1</span><br><span class="line">       4: invokestatic  #2                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span><br><span class="line">       <span class="number">7</span>: astore_2</span><br><span class="line">       8: new           #3                  // class java/lang/Integer</span><br><span class="line">      <span class="number">11</span>: dup</span><br><span class="line">      <span class="number">12</span>: bipush        <span class="number">127</span></span><br><span class="line">      14: invokespecial #4                  // Method java/lang/Integer."&lt;init&gt;":(I)V</span><br><span class="line">      <span class="number">17</span>: astore_3</span><br><span class="line">      <span class="number">18</span>: bipush        <span class="number">127</span></span><br><span class="line">      20: invokestatic  #2                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span><br><span class="line">      <span class="number">23</span>: astore        <span class="number">4</span></span><br><span class="line">      25: new           #3                  // class java/lang/Integer</span><br><span class="line">      <span class="number">28</span>: dup</span><br><span class="line">      <span class="number">29</span>: iload_1</span><br><span class="line">      30: invokespecial #4                  // Method java/lang/Integer."&lt;init&gt;":(I)V</span><br><span class="line">      <span class="number">33</span>: astore        <span class="number">5</span></span><br><span class="line">      <span class="number">35</span>: aload_2</span><br><span class="line">      36: invokevirtual #5                  // Method java/lang/Integer.intValue:()I</span><br><span class="line">      <span class="number">39</span>: istore        <span class="number">6</span></span><br><span class="line">      41: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">      <span class="number">44</span>: iload_1</span><br><span class="line">      <span class="number">45</span>: aload_2</span><br><span class="line">      46: invokevirtual #5                  // Method java/lang/Integer.intValue:()I</span><br><span class="line">      <span class="number">49</span>: if_icmpne     <span class="number">56</span></span><br><span class="line">      <span class="number">52</span>: iconst_1</span><br><span class="line">      <span class="number">53</span>: goto          <span class="number">57</span></span><br><span class="line">      <span class="number">56</span>: iconst_0</span><br><span class="line">      57: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">      60: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">      <span class="number">63</span>: iload_1</span><br><span class="line">      <span class="number">64</span>: aload_3</span><br><span class="line">      65: invokevirtual #5                  // Method java/lang/Integer.intValue:()I</span><br><span class="line">      <span class="number">68</span>: if_icmpne     <span class="number">75</span></span><br><span class="line">      <span class="number">71</span>: iconst_1</span><br><span class="line">      <span class="number">72</span>: goto          <span class="number">76</span></span><br><span class="line">      <span class="number">75</span>: iconst_0</span><br><span class="line">      76: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">      79: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">      <span class="number">82</span>: iload_1</span><br><span class="line">      <span class="number">83</span>: aload         <span class="number">4</span></span><br><span class="line">      85: invokevirtual #5                  // Method java/lang/Integer.intValue:()I</span><br><span class="line">      <span class="number">88</span>: if_icmpne     <span class="number">95</span></span><br><span class="line">      <span class="number">91</span>: iconst_1</span><br><span class="line">      <span class="number">92</span>: goto          <span class="number">96</span></span><br><span class="line">      <span class="number">95</span>: iconst_0</span><br><span class="line">      96: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">      99: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">102</span>: iload_1</span><br><span class="line">     <span class="number">103</span>: aload         <span class="number">5</span></span><br><span class="line">     105: invokevirtual #5                  // Method java/lang/Integer.intValue:()I</span><br><span class="line">     <span class="number">108</span>: if_icmpne     <span class="number">115</span></span><br><span class="line">     <span class="number">111</span>: iconst_1</span><br><span class="line">     <span class="number">112</span>: goto          <span class="number">116</span></span><br><span class="line">     <span class="number">115</span>: iconst_0</span><br><span class="line">     116: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     119: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">122</span>: aload_2</span><br><span class="line">     <span class="number">123</span>: aload_3</span><br><span class="line">     <span class="number">124</span>: if_acmpne     <span class="number">131</span></span><br><span class="line">     <span class="number">127</span>: iconst_1</span><br><span class="line">     <span class="number">128</span>: goto          <span class="number">132</span></span><br><span class="line">     <span class="number">131</span>: iconst_0</span><br><span class="line">     132: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     135: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">138</span>: aload_2</span><br><span class="line">     <span class="number">139</span>: aload         <span class="number">4</span></span><br><span class="line">     <span class="number">141</span>: if_acmpne     <span class="number">148</span></span><br><span class="line">     <span class="number">144</span>: iconst_1</span><br><span class="line">     <span class="number">145</span>: goto          <span class="number">149</span></span><br><span class="line">     <span class="number">148</span>: iconst_0</span><br><span class="line">     149: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     152: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">155</span>: aload_2</span><br><span class="line">     <span class="number">156</span>: aload         <span class="number">5</span></span><br><span class="line">     <span class="number">158</span>: if_acmpne     <span class="number">165</span></span><br><span class="line">     <span class="number">161</span>: iconst_1</span><br><span class="line">     <span class="number">162</span>: goto          <span class="number">166</span></span><br><span class="line">     <span class="number">165</span>: iconst_0</span><br><span class="line">     166: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     169: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">172</span>: aload_3</span><br><span class="line">     <span class="number">173</span>: aload         <span class="number">4</span></span><br><span class="line">     <span class="number">175</span>: if_acmpne     <span class="number">182</span></span><br><span class="line">     <span class="number">178</span>: iconst_1</span><br><span class="line">     <span class="number">179</span>: goto          <span class="number">183</span></span><br><span class="line">     <span class="number">182</span>: iconst_0</span><br><span class="line">     183: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     186: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">189</span>: aload_3</span><br><span class="line">     <span class="number">190</span>: aload         <span class="number">5</span></span><br><span class="line">     <span class="number">192</span>: if_acmpne     <span class="number">199</span></span><br><span class="line">     <span class="number">195</span>: iconst_1</span><br><span class="line">     <span class="number">196</span>: goto          <span class="number">200</span></span><br><span class="line">     <span class="number">199</span>: iconst_0</span><br><span class="line">     200: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     203: getstatic     #6                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">     <span class="number">206</span>: aload         <span class="number">4</span></span><br><span class="line">     <span class="number">208</span>: aload         <span class="number">5</span></span><br><span class="line">     <span class="number">210</span>: if_acmpne     <span class="number">217</span></span><br><span class="line">     <span class="number">213</span>: iconst_1</span><br><span class="line">     <span class="number">214</span>: goto          <span class="number">218</span></span><br><span class="line">     <span class="number">217</span>: iconst_0</span><br><span class="line">     218: invokevirtual #7                  // Method java/io/PrintStream.println:(Z)V</span><br><span class="line">     <span class="number">221</span>: <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们忽略输出语句，所得的字节码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">➜  interview git:(master) ✗ javap -c IntegerSolution  </span><br><span class="line">警告: 二进制文件IntegerSolution包含com.masonluo.practise.algorithm.interview.IntegerSolution</span><br><span class="line">Compiled from <span class="string">"IntegerSolution.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">masonluo</span>.<span class="title">practise</span>.<span class="title">algorithm</span>.<span class="title">interview</span>.<span class="title">IntegerSolution</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> com.masonluo.practise.algorithm.interview.IntegerSolution();</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       1: invokespecial #1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(java.lang.String[])</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: bipush        <span class="number">127</span></span><br><span class="line">       <span class="number">2</span>: istore_1</span><br><span class="line">       <span class="number">3</span>: iload_1</span><br><span class="line">       4: invokestatic  #2                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span><br><span class="line">       <span class="number">7</span>: astore_2</span><br><span class="line">       8: new           #3                  // class java/lang/Integer</span><br><span class="line">      <span class="number">11</span>: dup</span><br><span class="line">      <span class="number">12</span>: bipush        <span class="number">127</span></span><br><span class="line">      14: invokespecial #4                  // Method java/lang/Integer."&lt;init&gt;":(I)V</span><br><span class="line">      <span class="number">17</span>: astore_3</span><br><span class="line">      <span class="number">18</span>: bipush        <span class="number">127</span></span><br><span class="line">      20: invokestatic  #2                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span><br><span class="line">      <span class="number">23</span>: astore        <span class="number">4</span></span><br><span class="line">      25: new           #3                  // class java/lang/Integer</span><br><span class="line">      <span class="number">28</span>: dup</span><br><span class="line">      <span class="number">29</span>: iload_1</span><br><span class="line">      30: invokespecial #4                  // Method java/lang/Integer."&lt;init&gt;":(I)V</span><br><span class="line">      <span class="number">33</span>: astore        <span class="number">5</span></span><br><span class="line">      <span class="number">35</span>: aload_2</span><br><span class="line">      36: invokevirtual #5                  // Method java/lang/Integer.intValue:()I</span><br><span class="line">      <span class="number">39</span>: istore        <span class="number">6</span></span><br><span class="line">      <span class="number">41</span>: <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由上图可以看出，自动装箱是调用了<strong>Integer.valueOf</strong>方法，而自动拆箱是调用了<strong>Integer.intValue()</strong>方法。</p>
<p>那么Integet.valueOf()方法究竟是怎样的呢？我们来看一下这个方法的源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class="line">          <span class="comment">// 因为Cache的下标是从0开始的，但是low为-128, 所以i值要相对应的加上128</span></span><br><span class="line">            <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里的Integer.valueOf方法表明，<strong>当传入的 i 值 大于或者等于 IntegerCache.low 并且 小于或者等于 IntegerCache.high的时候，返回的都是Integer.cache中缓存的对象，而不是一个新的对象</strong>，那么IntegerCache中这两个值的大小是多少呢？再继续找源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerCache</span> </span>&#123;</span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> low = -<span class="number">128</span>;</span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> high;</span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">static</span> &#123;</span><br><span class="line">           <span class="comment">// high value may be configured by property</span></span><br><span class="line">           <span class="keyword">int</span> h = <span class="number">127</span>;</span><br><span class="line">           String integerCacheHighPropValue =</span><br><span class="line">               sun.misc.VM.getSavedProperty(<span class="string">"java.lang.Integer.IntegerCache.high"</span>);</span><br><span class="line">           <span class="keyword">if</span> (integerCacheHighPropValue != <span class="keyword">null</span>) &#123;</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="keyword">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class="line">                   i = Math.max(i, <span class="number">127</span>);</span><br><span class="line">                   <span class="comment">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class="line">                   h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="number">1</span>);</span><br><span class="line">               &#125; <span class="keyword">catch</span>( NumberFormatException nfe) &#123;</span><br><span class="line">                   <span class="comment">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           high = h;</span><br><span class="line">   </span><br><span class="line">           cache = <span class="keyword">new</span> Integer[(high - low) + <span class="number">1</span>];</span><br><span class="line">           <span class="keyword">int</span> j = low;</span><br><span class="line">         <span class="comment">// new 一个新的Integer，放入缓存</span></span><br><span class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; cache.length; k++)</span><br><span class="line">               cache[k] = <span class="keyword">new</span> Integer(j++);</span><br><span class="line">   </span><br><span class="line">           <span class="comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class="line">           <span class="keyword">assert</span> IntegerCache.high &gt;= <span class="number">127</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="function"><span class="keyword">private</span> <span class="title">IntegerCache</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p><strong>这里表明，high的值为127，low的值为-128，然后逐个new一个新的Integer，放入cache中，如果调用Integer.valueOf的时候， i &gt;= -128 &amp;&amp; i &lt;= 127，就会返回一个一样的对象。</strong></p>
<p>这样就很明确了，来总结一下：</p>
<ul>
<li><strong>当进行自动拆箱的时候，调用的是Integet.intValue()方法，返回的是一个基本的数据类型</strong></li>
<li><strong>当进行自动装箱的时候，调用的是Integet.valueOf()方法，如果要装箱的数值 在[-128, 127]的范围内，就会返回一个已经缓存好了的对象，而不是新的对象；否则，调用 new Integer(i)返回一个新的对象</strong></li>
</ul>
<p>下面来解释一下，上面这样输出的原因(<strong>看注释的标号</strong>)：</p>
<ol>
<li>基本类型和包装类型进行比较，都会将包装类型进行拆箱，得到基本数据类型，然后比较，所以为true</li>
<li>同上</li>
<li>同上</li>
<li>同上</li>
<li><strong>Integer num2 = num1</strong>, 实际上是 I<strong>nteger num2 = Integet.valueOf(num1)</strong>，所以返<strong>回一个cache中的Integer对象</strong>， num3 调用了 new Integer(127)，<strong>返回的是一个新的对象</strong>，两者是引用类型，地址不相同，所以为false</li>
<li>num4同样调用Integer.valueOf方法，所以和num2是同一个对象</li>
<li>参考5，6</li>
<li>参考5，6</li>
<li>两个都是new了一个新的对象，所以在堆里面的地址不相同，直接比较是比较地址，所以为false</li>
<li>参考上面</li>
</ol>
<p>让我们把数字换一下，换成128，来看看有怎样的输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerSolution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> num1 = <span class="number">128</span>;</span><br><span class="line"></span><br><span class="line">        Integer num2 = num1;</span><br><span class="line"></span><br><span class="line">        Integer num3 = <span class="keyword">new</span> Integer(<span class="number">128</span>);</span><br><span class="line"></span><br><span class="line">        Integer num4 = Integer.valueOf(<span class="number">128</span>);</span><br><span class="line"></span><br><span class="line">        Integer num5 = <span class="keyword">new</span> Integer(num1);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> num6 = num2;</span><br><span class="line"></span><br><span class="line">        Integer num7 = num1;</span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num2); <span class="comment">// 1. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num3); <span class="comment">// 2. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num4); <span class="comment">// 3. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num1 == num5); <span class="comment">// 4. true</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num2 == num3); <span class="comment">// 5. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num2 == num4); <span class="comment">// 6. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num2 == num5); <span class="comment">// 7. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num3 == num4); <span class="comment">// 8. false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num3 == num5); <span class="comment">// 9.false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num4 == num5); <span class="comment">// 10.false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(num7 == num2); <span class="comment">// 11. false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为是128，所以每次自动装箱或者调用Integet.valueOf都是new一个新的对象，所以很容易进行判断，在此不做解释了。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/java/" rel="tag"># java</a>
          
            <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag"># 面试题</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/28/%E7%AE%97%E6%B3%95/OJ/%E9%AA%91%E5%A3%AB%E9%97%AE%E9%A2%98/" rel="next" title="骑士问题">
                <i class="fa fa-chevron-left"></i> 骑士问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/header.jpg"
                alt="Masonluo" />
            
              <p class="site-author-name" itemprop="name">Masonluo</p>
              <p class="site-description motion-element" itemprop="description">白了少年头</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
	  <audio controls="controls" playsinline="" webkit-playsinline="">
          <source src="//music.163.com/outchain/player?type=0&id=3092942333&auto=1&height=66" type="audio/mpeg"></audio>
          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#String"><span class="nav-number">1.</span> <span class="nav-text">String</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#经典案例"><span class="nav-number">1.1.</span> <span class="nav-text">经典案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Integer"><span class="nav-number">2.</span> <span class="nav-text">Integer</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Masonluo</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
